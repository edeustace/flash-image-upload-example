package {    	import com.adobe.images.JPGEncoder;	import com.ee.Button;		import flash.display.Bitmap;	import flash.display.BitmapData;	import flash.display.LoaderInfo;	import flash.display.MovieClip;	import flash.display.Sprite;	import flash.display.StageAlign;	import flash.display.StageScaleMode;	import flash.events.*;	import flash.events.Event;	import flash.external.ExternalInterface;	import flash.geom.Matrix;	import flash.media.Camera;	import flash.media.Sound;	import flash.media.SoundChannel;	import flash.media.Video;	import flash.net.*;	import flash.net.FileReference;	import flash.net.URLRequest;	import flash.net.URLRequestMethod;	import flash.net.URLVariables;	import flash.net.navigateToURL;	import flash.net.sendToURL;	import flash.system.Security;	import flash.system.SecurityPanel;	import flash.utils.*;		import ru.inspirit.net.MultipartURLLoader;	    public class form extends Sprite {      	public var uploadButton : Button;		 public function form()	 {		 uploadButton = new Button();		 uploadButton.y = 300;		 uploadButton.label = "upload";		 addChild(uploadButton);		 uploadButton.addEventListener(MouseEvent.CLICK, captureImage );		 		 init();	 }	 	 private var cam:Camera = Camera.getCamera();	 private var video:Video = new Video();	 private var bitmapData:BitmapData = new BitmapData(video.width,video.height);	 private var bitmap:Bitmap = new Bitmap(bitmapData);	 	 private function init():void	 {		 cam.setQuality(0, 100);		 cam.setMode(320,240,30,false); // setMode(videoWidth, videoHeight, video fps, favor area)		 video.attachCamera(cam);		 video.x = 0;		 video.y = 0;		 addChild(video);		 trace("video added");		 bitmap.x = 360;		 bitmap.y = 0;		 addChild(bitmap);	 }	 	 private function captureImage(e:MouseEvent):void {		 bitmapData.draw(video);		 onSaveJpg(null);	 }	 	 	 private function onSaveJpg(e:Event):void{		 var myEncoder:JPGEncoder = new JPGEncoder(100);		 var byteArray:ByteArray = myEncoder.encode(bitmapData);		 		 var data1:ByteArray = byteArray;		 //data1.position = 0;		 		 var ml:MultipartURLLoader = new MultipartURLLoader();		 ml.addEventListener(Event.COMPLETE, function(event:Event){ trace("done");});		 		 ml.addFile(data1, 'screengrab.jpg', 'file');		 		 ml.load('http://localhost:8080/example/UploadImage');		 		 function sendComplete(event:Event):void{			 trace("send complete");		 }		 	 }	  	     }}